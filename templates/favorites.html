<!doctype html><meta charset="utf-8">
<title>즐겨찾기</title>
<style>
  body{font-family:system-ui,Malgun Gothic,sans-serif;max-width:1000px;margin:auto;padding:24px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
  .card{border:1px solid #ddd;border-radius:12px;padding:10px}
  img{width:100%;height:180px;object-fit:cover;border-radius:8px}
  .topbar a{margin-right:12px}
  button{border:1px solid #ccc;border-radius:8px;padding:6px 10px;background:#fafafa;cursor:pointer}
</style>
<div class="topbar">
  <a href="/">← 홈</a>
</div>
<h2>내 즐겨찾기</h2>

{% if favs and favs|length > 0 %}
  <div class="grid">
    {% for f in favs %}
      <div class="card" data-mid="{{ f.mongo_id }}">
        <img src="/mongo/{{ f.mongo_id }}" alt="{{ f.filename }}">
        <div><b>{{ f.filename }}</b></div>
        <button class="remove">즐겨찾기 해제</button>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>저장된 즐겨찾기가 없습니다.</p>
{% endif %}

<script>
document.querySelectorAll('.remove').forEach(btn=>{
  btn.addEventListener('click', async e=>{
    const card = e.target.closest('.card');
    const mongo_id = card.dataset.mid;
    const res = await fetch('/unlike', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({mongo_id})
    });
    const j = await res.json();
    if(j.ok){ card.remove(); }
  });
});
</script>
